#  Разработка приложения Stets для умного дома

## Задача


## Процесс работы

### Анализ интервью

Провела анализ интервью с [заинтересованными лицами](https://docs.google.com/document/d/1z7ZkVg6m7pPShPeQIt89Gc2b0x6KT_bNbk2Yc8abUjU/edit?usp=sharing). Выделила из интервью заказчиком и пользователями функции, которые необходимы в первой итерации MVP.

<details>
  <summary><b>Обязательные функции MVP</b></summary>

  <ul>
    <li>Регистрация</li>
    <li>Авторизация / Аутентификация с помощью эл.почты и пароля</li>
    <li>Выход из учётной записи</li>
    <li>Восстановление пароля</li>
    <li>Замена эл.почты</li>
    <li>Добавление пользователя</li>
    <li>Добавление устройства через QR код</li>
    <li>Добавление устройства вручную</li>
    <li>Удаление устройства</li>
    <li>Выбор энергосберегающего режима</li>
    <li>Добавление комнаты</li>
    <li>Удаление комнаты</li>
    <li>Изменение данных комнаты</li>
    <li>Управление освещением</li>
    <li>Добавление устройства в комнату</li>
    <li>Удаление устройства из комнаты</li>
    <li>Управление всеми устройствами в комнате сразу</li>
    <li>Создание сценария автоматизации</li>
    <li>Запуск сценария автоматизации вручную</li>
    <li>Создание сценария с ручным запуском</li>
    <li>Создание сценария с автоматическим запуском</li>
    <li>Принудительный запуск сценария, с заданным расписанием</li>
    <li>Удаление сценария автоматизации</li>
  </ul>
</details>

<details>
  <summary><b>Общие требования</b></summary>
  
  #### Объекты приложения:
  <ul>
    <li>Пользователь</li>
    <li>Дом</li>
    <li>Комната</li>
    <li>Устройство</li>
    <li>Сценарий</li>
  </ul>

  #### Требования к функциональности:

  #### Создание дома:
  * Автоматическое создание первого дома после регистрации пользователя.

  #### Управление домами:
  * Возможность управления несколькими домами одним пользователем.
  * Максимальное количество домов на одного пользователя: 10.

  #### Комнаты:
  * Максимальное количество комнат в одном доме: 10.
  * Комнаты могут иметь уникальные названия и иконки из предустановленного набора.
  * Пользователь может добавлять устройства без привязки к комнатам.

  #### Устройства:
  * Каждое устройство должно иметь уникальный 12-значный код для идентификации.
  * Максимальное количество устройств в одном доме: 100.
  * Пользователь может присваивать индивидуальные названия устройствам.
  * **Статусы устройства:**
    * Включено
    * Выключено
    * Недоступно

  #### Сценарии автоматизации:
  * Максимальное количество сценариев: 10.
  * В первой версии сценарии должны быть простыми (включение/выключение устройств по расписанию или вручную).
  * Возможность добавления нескольких устройств в один сценарий с указанием их состояния (включить/выключить).

  #### Свойства сценария:
  * Дни недели и время запуска.
  * Название сценария (до 30 знаков).
  * Время окончания сценария.
  * Отдельный сценарий на выключение освещения в нужное время. Пользователь может создать отдельный сценарий, который автоматически выключает освещение в заданное время.

  #### Требования к пользователю:
  
  #### Регистрация пользователя:
  * Регистрация через электронную почту и пароль.
  * Электронная почта используется как логин и для отправки уведомлений.
  * Необходимо имя пользователя для идентификации.

  #### Требования к паролю:
  * Длина от 8 до 16 символов.
  * Должен содержать как минимум одну строчную и одну прописную букву латинского алфавита.
</details>




### Карта пользовательских историй и MVP

Составила [User Story Map (USM)](https://miro.com/app/board/uXjVIciAY-8=/) для приложения умного дома, включающая User Stories, сформулированные в соответствии с принципами INVEST. Пользовательские истории, вошедшие в MVP, дополнены критериями и сценариями приемки, написанными на языке Gherkin.


### DFD контекстного и логического уровня

Процессы смоделированы с использованием диаграммы потоков данных (DFD).

![Обновленная диаграмма UML](https://github.com/EVTrukhina/practicum_Y/blob/main/DFD%20контекстная%20Stets.png)
<p align="center">Рис 1. DFD контекстного уровня </p>


![Обновленная диаграмма UML](https://github.com/EVTrukhina/practicum_Y/blob/main/DFD%20логическая%20Stets.png)
<p align="center">Рис 2. DFD логического уровня </p>


### Логическая ER-модель в 3 НФ

Смоделирована структура данных с использованием логической ER-диаграммы в нотации Crow's Foot (нотация Мартина).
![Обновленная диаграмма UML](https://github.com/EVTrukhina/practicum_Y/blob/main/ER-диаграмма.png)
<p align="center">Рис 3. Логическая ER-модель в 3НФ </p>

### Словарь данных

| Элемент данных | Описание | Состав или тип данных | Длина | Значения |
|---|---|---|---|---|
| **Пользователь** | Данные пользователя, указанные при регистрации |Электронная почта<br>+ Имя пользователя<br>+ Пароль пользователя |  |  |
| Электронная почта | Адрес электронной почты пользователя, предоставленный при регистрации. | Символьно-числовое значение | 100 | Должен содержать символ @ |
| Имя | Имя пользователя | Символьное значение | 60 |  |
| Пароль | Пароль пользователя, предоставленный при регистрации. Используется для аутентификации. | Символьно-числовое значение | 8-16 | Должен содержать минимум 1 строчную и 1 прописную букву латинского алфавита |
| **Дом** | Дом для управления | Код дома<br>+ Название дома<br>+ 1:10 {дом}<br>+ 1:10 {комнат}<br>+ 1:10 {сценариев}<br>+ 1:100 {устройств} |  |  |
| Код дома | Синтетический первичный ключ дома | Целое и положительное | 12 |  |
| Название дома | Название дома, задается пользователем | Символьное значение | 30 |  |
| Доступ к дому | Связывает пользователей с домами, определяя уровень доступа | Электронная почта<br>+ Код дома<br>+ Уровень доступа |  |  |
| Уровень доступа | Уровень прав пользователя | Символьное значение |  |  |
| **Комната** | Помещения различного типа | Код комнаты<br>+ Код дома<br>+ Код типа комнаты<br>+ Название комнаты |  |  |
| Код комнаты | Синтетический первичный ключ комнаты | Целое и положительное | 20 |  |
| Код типа комнаты | Синтетический первичный ключ типа комнаты | Целое и положительное | 20 |  |
| Название комнаты | Название комнаты, предлагаемое системой на основе выбранного типа комнаты “Спальня”, или заданное пользователем вручную | Символьно-числовое значение | 30 | Тип комнаты + цифра при повторе, или любое название |
| **Тип комнаты** |  |  Код типа комнаты<br>+ Название типа комнаты<br>+ Иллюстрация комнаты|  |  |
| Код типа комнаты | Синтетический первичный ключ типа комнаты | Целое и положительное | 20 |  |
| Название типа комнаты | Типа комнат (например, “Тип: Спальня”). | Символьное значение | 30 |  |
| Иллюстрация комнаты | Изображение со значением типа комнаты | Файл |  | .img |
| **Устройство** | Устройства пользователя добавленные в приложение умного дома | ID устройства<br>+ Код модели устройства<br>+ Код дома<br>+ Код комнаты<br>+ Название устройства<br>+ Статус устройства<br>+ Статус режима энергосбережения<br>+ Цвет<br>+ Яркость  |  |  |
| ID устройства | Уникальный 12-значный код для идентификации | Числовое значение | 12 |  |
| Код модели устройства | Уникальный код модели устройства | Символьно-числовое значение | 25 |  |
| Название устройства | Название устройства заданное пользователем | Символьное значение | 30 |  |
| Статус устройства | Состояние устройства | Символьное значение | 10 | Включено, не включено, недоступно |
| Статус режима энергосбережения | Статус режим энергосбережения для устройства | Символьное значение | 10 | Включено, не включено, недоступно |
| Цвет | Оттенок цвета | Символьно-числовое значение | 25 |  |
| Яркость | Интенсивность цвета | Числовое значение | 25 |  |
| **Модель устройства** | Информация о типе и характеристиках устройства | Код модели устройства<br> Код типа устройства |  |  |
| Код модели устройства | Уникальный код модели устройства | Символьно-числовое значение | 25 |  |
| Код типа устройства | Уникальный код типа устройства | Символьно-числовое значение | 25 |  |
| **Тип устройства** |  | Код типа устройства<br>+ Тип устройства |  |  |
| Код типа устройства | Уникальный код типа устройства | Символьно-числовое значение | 25 |  |
| Тип устройства | Информация о типе устройства (лампочка, розетка) | Символьное значение | 30 |  |
| **Сценарий** | Сценарии заданные пользователем для автоматизации управления умным домом | Код сценария<br>+ Код дома<br>+ Название сценария<br>+ Тип запуска<br>+ Время запуска<br>+ Дни недели<br>+ Статус сценария  |  |  |
| Код сценария | Синтетический первичный ключ кода сценария | Целое и положительное | 12 |  |
| Название сценария | Название сценария присвоенное пользователем | Символьное значение | 30 |  |
| Тип запуска | Тип запуска: ручной или автоматический | Символьное значение | 30 |  |
| Время запуска | Время начала сценария | Время ЧЧ:MM |  |  |
| Дни недели | Дни недели в которые должен срабатывать сценарий автоматизации | Символьное значение |  |  |
| Статус сценария | Состояние сценария | Символьное значение | 10 | Не включен, включен, завершен, недоступен |
| **Сценарий устройство** |  | Код сценария<br>+ ID устройства<br>+ Статус устройства |  |  |
| Код сценария | Синтетический первичный ключ кода сценария | Целое и положительное |  |  |
| ID устройства | Уникальный 12-значный код для идентификации | Числовое значение | 12 |  |
| Статус устройства | Состояние устройства | Символьное значение | 10 | Включено, не включено, недоступно |
| **День недели в сценарии** | Связывает сценарии с днями недели | Код сценария<br>+ Код дня недели<br>+ Код дома |  |  |
| Код сценария | Синтетический первичный ключ кода сценария | Целое и положительное | 12 |  |
| Код дня недели | Синтетический первичный ключ кода дня недели | Целое и положительное | 12 |  |
| Код дома | Синтетический первичный ключ дома | Целое и положительное | 12 |  |
| **День недели** | Дни недели для запуска сценариев |  Код дня недели<br>+ Название дня недели |  |  |
| Код дня недели | Синтетический первичный ключ дня недели | Целое и положительное | 12 |  |
| Название дня недели | День недели для выбора запуска сценария | Символьное значение | 15 | Пн, Вт, Ср, Чт, Пт, Сб, Вс |
| **Код подтверждения** |  | Код<br>+ Тип кода<br>+ Электронная почта (новая)<br>+ Дата и время создания<br>+ Дата и время истечения |  |  |
| Код подтверждения | Синтетический первичный ключ кода сценария | Целое и положительное | 12 |  |
| Тип кода | Тип кода: восстановление пароля или замена email | Символьное значение | 30 |  |
| Электронная почта (новая) | Электронный адрес, который пользователь пытается установить | Символьно-числовое значение | 100 | Должен содержать символ @ |
| Дата и время создания | Дата и время, когда был сгенерирован код подтверждения | Дата, время, дд.мм.гггг чч:мм |  |  |
| Дата и время истечения | Дата и время, когда код подтверждения становится недействительным | Дата, время, дд.мм.гггг чч:мм |  |  |


### Разработка прототипа

Спроектированы раскадровки (сториборды) в [Figma](https://www.figma.com/design/fUxcfzLGlIDoNIDEB0oE5N/%D0%94%D0%B8%D0%B7%D0%B0%D0%B9%D0%BD-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0-Stets.-%D0%A2%D1%80%D1%83%D1%85%D0%B8%D0%BD%D0%BE%D0%B9-%D0%95%D0%BB%D0%B5%D0%BD%D1%8B?node-id=4-581&t=pKLSxZlJKU8wwBBU-1) для всех функций приложения, включенных в MVP, с учетом диаграммы потоков данных и логической модели данных.

![Обновленная диаграмма UML](https://github.com/EVTrukhina/practicum_Y/blob/main/Формирование%20устройств%20в%20доме.png)
<p align="center">Рис 4. Формирование устройств в доме </p>

### Разработка ПМИ
## Программа и методика испытаний

**Объект испытаний:** Мобильное приложение «Stets» версии 1.0

**Цель испытаний:** Проверить соответствие выполненных работ предъявленным требованиям заказчика.

**Требования к программе:** TR-1, TR-1.1, TR-1.2, TR-1.3; TR-2, TR-2.1, TR-2.2; TR-3, TR-3.1, TR-3.2; TR-4, TR-4.1, TR-4.2, TR-4.3, TR-4.4, TR-4.5; TR-5, TR-5.1, TR-5.2, TR-5.3, TR-5.4, TR-5.5, TR-5.6, TR-5.7; TR-6, TR-6.1, TR-6.2, TR-6.3, TR-6.4, TR-6.5; TR-7, TR-7.1, TR-7.2, TR-7.3

**Средства и порядок испытаний:**
*   Мобильный телефон с операционной системой iOS или Android;
*   Доступ в интернет.

**Требования к документации:** - Программа и методика испытаний (ПМИ) сервиса
| Требование технического задания | Предусловия | Шаг проверки | Конечный результат |
|---|---|---|---|
| **TR-1: регистрация в приложении** |  
| TR-1: регистрация в приложении | Пользователь регистрируется в приложении впервые | 1. Нажать на экране входа кнопку «Зарегистрироваться»<br>2. Указать валидное значение в поле «Имя»<br>3. Указать валидное значение в поле «Электронной почты»<br>4. Ввести пароль (в соот. с требованиями)<br>5. Повторить пароль<br>6. Нажать на кнопку «Создать аккаунт»<br>7. Получить письмо об успешной регистрации | 1. Экран с регистрацией в приложении<br>2. Указаны валидные значения в полях ввода: имя и эл.почта<br>3. Значения в поле ввода «Пароль» и «Пароль повторно» совпадают.<br>4. Кнопка «Создать аккаунт» становится активной<br>5. Пользователь успешно зарегистрирован<br>6. На указанный адрес электронной почты приходит письмо об успешной регистрации |
| TR-1.1: регистрация в приложении. Альтернативный сценарий: неверный формат электронной почты | Пользователь регистрируется в приложении впервые | 1. Указать валидное значение в поле «Имя»<br>2. Указать не валидное значение в поле «Электронной почты»<br>3. Ввести пароль (в соот. с требованиями)<br>4. Повторить пароль<br>5. Нажать на кнопку «Создать аккаунт» | 1. Указано валидное значения в поле ввода «Имя»<br>2. Указано не валидное значения в поле ввода «Электронной почты»<br>3. Значения в поле ввода «Пароль» и «Пароль повторно» совпадают.<br>4. Кнопка «Создать аккаунт» становится активной<br>5. Поле ввода элек. почты подсвечивается при невалидном значении красным цветом<br>6. Отображается всплывающее сообщение (подсказка) в верхней части экрана «Неверный формат электронной почты» |
| TR-1.2: регистрация в приложении. Альтернативный сценарий: пароли не совпадают | Пользователь регистрируется в приложении впервые | 1. Указать валидное значение в поле «Имя»<br>2. Указать валидное значение в поле «Электронной почты»<br>3. Ввести пароль (в соот. с требованиями)<br>4. Повторить пароль с ошибкой<br>5. Нажать на кнопку «Создать аккаунт» | 1. Указаны валидные значения в полях ввода: имя и эл.почта<br>2. Значения в поле ввода «Пароль» валиден<br>3. Значения в поле ввода «Повторить пароль» указано с ошибкой<br>4. Кнопка «Создать аккаунт» становится активной<br>5. Повторить пароль подсвечивается красным цветом<br>6. Отобразилось уведомление об ошибке «Пароли не совпадают» |
| TR-1.3: регистрация в приложении. Альтернативный сценарий: неверно заданный пароль | Пользователь регистрируется в приложении впервые | 1. Указать валидное значение в поле «Имя»<br>2. Указать валидное значение в поле «Электронной почты»<br>3. Ввести пароль не соот. с требованиями<br>4. Повторить пароль не соот. с требованиями<br>5. Нажать на кнопку «Создать аккаунт» | 1. Указаны валидные значения в полях ввода: имя и эл.почта<br>2. Значения в поле ввода «Пароль» и «Повторить пароль» не валиден не соот. требованиям<br>3. Кнопка «Создать аккаунт» становится активной<br>4. Значения в поле ввода «Пароль подсвечивается красным цветом<br>5. Отобразилось уведомление об ошибке «Пароли не соответствует требованиям» |
| **TR-2: авторизация в приложении (вход)** |  
| TR-2: авторизация в приложении (вход)<br>TR-2: авторизация с помощью эл.почты и пароля | Учетная запись пользователя зарегистрирована | 1. Указать валидное значение в поле «Электронной почты»<br>2. Ввести заданный пароль<br>3. Нажать на кнопку «Войти» | 1. Введенные значения в полях «Электронная почта» и «Пароль» валидны (соответствуют зарегистрированным данным)<br>2. Кнопка «Войти» становится активной<br>3. Пользователь успешно авторизован |
| TR-2.1: авторизация с помощью эл.почты и пароля. Альтернативный сценарий: неверный пароль | Учетная запись пользователя зарегистрирована | 1. Указать валидное значение в поле «Электронной почты»<br>2. Ввести не валидное значение пароля<br>3. Нажать на кнопку «Войти» | 1. Указано валидное значение в поле «Электронной почты»<br>2. Введено не валидное значение пароля<br>3. Кнопка «Войти» становится активной<br>4. Поле пароль подсвечивается красным цветом<br>5. Отобразилось уведомление об ошибке «Неверный пароль» |
| TR-2.2: авторизация с помощью эл.почты и пароля. Альтернативный сценарий: несуществующий email | Пользователь с введенный email не зарегистрирован | 1. Указать валидное значение в поле «Электронной почты»<br>2. Ввести валидное значение пароля (в соот. с требованиями)<br>3. Нажать на кнопку «Войти» | 1. Введенные значения в полях «Электронная почта» и «Пароль» валидны<br>2. Кнопка «Войти» становится активной<br>3. Поле «Электронной почты» подсвечивается красным цветом<br>4. Отобразилось уведомление об ошибке «Пользователь с таким email не найден» |
| **TR-3: восстановление пароля** |  
| TR-3: восстановление пароля |  | 1. Нажать на экране входа кнопку «Восстановить пароль»<br>2. Указать валидное значение в поле «Электронной почты»<br>3. Нажать на кнопку «Отправить код»<br>4. Указать 4-значный код подтверждения в течении 5 минут на эл.почту<br>5. Указать новый пароль (в соот. с требованиями)<br>6. Повторить новый пароль<br>7. Нажать на кнопку «Сохранить» | 1. Экран с восстановлением пароля<br>2. Указано валидное значение в поле «Электронной почты»<br>3. На указанный адрес электронной почты приходит письмо с информацией о 4 значном коде подтверждения<br>4. Указано валиднее значения в полях ввода код подтверждения<br>5. Значения в поле ввода «Пароль» валидно<br>6. Значения в поле ввода «Пароль» и «Пароль повторно» совпадают<br>7. Кнопка «Сохранить» становится активной<br>8. Система оповещает, что пароль успешно задан |
| TR-3.1: восстановление пароля. Альтернативный сценарий: истекло время действия кода подтверждения email |  | 1. Указать валидное значение в поле «Электронной почты»<br>2. Нажать на кнопку «Отправить»<br>3. Указать 4-значный код подтверждения после истечения 5 минут<br>4. Нажать на кнопку «Выслать код ещё раз» | 1. Указано валидное значение в поле «Электронной почты»<br>2. На указанный адрес электронной почты приходит письмо с информацией о 4 значном коде подтверждения<br>3. Ввод устаревшего значения кода подтверждения в поле ввода<br>4. Отобразилось уведомление «Код подтверждения устарел»<br>5. Поле ввода кода подсвечивается красным цветом<br>6. Кнопка «Выслать код ещё раз» активна |
| TR-3.2: восстановление пароля. Альтернативный сценарий: неверный код подтверждения |  | 1. Указать валидное значение в поле «Электронной почты»<br>2. Нажать на кнопку «Отправить»<br>3. Указать неверный 4-значный код подтверждения в течении 5 минут<br>4. Кнопка «Выслать код ещё раз» неактивна | 1. Указано валидное значение в поле «Электронной почты»<br>2. На указанный адрес электронной почты приходит письмо с информацией о 4 значном коде подтверждения<br>3. Указано не валидное значения в поле ввода код подтверждения<br>4. Поле поле ввода код подтверждения подсвечивается красным цветом с отображением ошибки «Введен неверный код»<br>5. Кнопка «Выслать код ещё раз» становится активной по истечению 5 минут |
