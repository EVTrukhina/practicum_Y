# Разработка API для сервиса Otium


Проект состоит из четырёх частей:
Интервью с представителем Otium. Сначала изучите интервью с представителем сервиса. Вам нужно понять требования заказчика. После интервью проверите, насколько это получилось.
Диаграмма последовательности. Создайте диаграмму последовательности, которая поможет разработчикам реализовать новую функцию сервиса.
Тестирование API в Swagger. Протестируйте существующее API сервиса в Swagger и ответьте на несколько вопросов.
Задача на разработку. Поставьте задачу на разработку новой операции API.

## Задача



## Процесс работы

### Анализ интервью с заказчиком
Проведен анализ представленного [интервью с заказчиком](https://docs.google.com/document/d/1cKapG1cH4Fv04UFsRkv0Bl2ugs78g-yjV7koLaKff0U/edit?usp=sharing), чтобы выяснить требования. Из интервью выделено следующее:

*   **Рейтинг от кинокритиков:**
    *   Отображение рейтинга, предоставленного кинокритиками, для каждого фильма и сериала (где доступно).
    *   Использование рейтинга кинокритиков как «экспертной оценки» для помощи пользователям в выборе контента.
    *   Добавление рейтинга кинокритиков в описание каждого фильма и сериала.

*   **Сортировка по рейтингу:**
    *   Возможность сортировки списков фильмов и сериалов по рейтингу (по возрастанию и убыванию).
    *   Поддержка сортировки как по рейтингу кинокритиков, так и по пользовательскому рейтингу.
    *   Применение сортировки после фильтрации (например, по жанру).

*   **Обработка контента без рейтинга:**
    *   Сохранение фильмов и сериалов без рейтинга кинокритиков в результатах поиска.
    *   Отображение контента без рейтинга в конце списка при сортировке по рейтингу (независимо от направления сортировки).

**Дополнительно:**

*   Рейтинг кинокритиков добавляется как атрибут сущности «фильм или сериал», без необходимости создания новой базы данных.

### Диаграмма последовательности

Сделана диаграмма последовательности, иллюстрирующая процесс фильтрации и последующей сортировки списка фильмов и сериалов.

![Обновленная диаграмма UML](https://github.com/EVTrukhina/practicum_Y/blob/main/Диаграмма%20последовательности%20Otium.png)
<p align="center">Рис 1. UML Sequence Diagram</p>




## Задача на разработку
Поставьте задачу на разработку новой операции API.

**Цель**

Дать пользователям возможность удобнее выбирать фильмы и сериалы для просмотра, опираясь на оценки других зрителей и профессиональных критиков.

**Требование**

Пользователь должен иметь возможность сортировать списки фильмов и сериалов как по рейтингу зрителей, так и по рейтингу кинокритиков, в порядке возрастания и убывания.

**Use Case**

1.  В разделе «Библиотека» пользователь видит список фильмов и сериалов.
2.  Пользователь в интерфейсе выбирает параметры, по которым он хочет отфильтровать список фильмов и сериалов, и/или режим сортировки.
3.  Система возвращает список фильмов и сериалов, отфильтрованный и отсортированный согласно указанным данным.

**Описание изменений**

1.  Необходимо доработать для Films Server API.
    *  В ответ `{{FilmsServer}}/films/list` добавить новое поле `criticsRating`.
    *   В ответ `{{FilmsServer}}/films` добавить новое поле `criticsRating`.

2.  Необходимо доработать для Series Server API.
    *   В ответ `{{SeriesServer}}/series/list` добавить новое поле `criticsRating`.
    *   В ответ `{{SeriesServer}}/series` добавить новое поле `criticsRating`.

3.  Необходимо доработать для Web Server API.
    *   В запрос `{{WebServer}}/content/list` добавить два query-параметра: `sortBy` и `direction`.
    *   В ответ `{{WebServer}}/content/list` добавить новое поле `criticsRating`.
    *   В ответ `{{WebServer}}/content/details` добавить новое поле `criticsRating`.

**Контекст** 

В ответе запроса `{{FilmsServer}}/films/list` и `{{SeriesServer}}/series/list` уже есть рейтинг зрителей `rating`, по которому также нужно будет выполнять сортировку.

### Операции Films Server API

1.1. В ответ `{{FilmsServer}}/films/list` в объект с детальным описанием каждого фильма необходимо добавить новое опциональное поле `criticsRating`. Поле должно заполняться данными о рейтинге кинокритиков.

**Тип метода:** GET

**URL запроса:** `/films/list`

**Параметры запроса:** -

**Пример запроса:** `https://2ee4902e-6893-4bf2-9b6f-88b9f5fcb78a.mock.pstmn.io/films/list`

**Элементы тела запроса:** -

**Пример ответа:**

```json
[
   {
       "id": 101,
       "type": "film",
       "title": "Хосэ Каньон",
       "description": "Хосэ Каньон — добрый и открытый парень — устроился в офис электриком и рассказывает коллегам историю своей необыкновенной жизни.",
       "imageUrl": "https://otium.imagestorage.ru/JoseCanyon.img",
       "previewUrl": "https://otium.previewstorage.ru/JoseCanyon.mov",
       "recordUrl": "https://otium.recordstorage.ru/JoseCanyon.mov",
       "genre": [
           "comedy"
       ],
       "recommended": true,
       "details": {
           "yearOfIssue": "1995",
           "duration": 152,
           "country": [
               "США"
           ],
           "ageRate": "16+"
       },
       "rating": 9.4,
       "criticsRating": 7.4
   }
]
```


| Элементы ответа | Тип    | Обязательность | Описание                                                              |Ошибки
|-----------------|--------|-----------------|---------------------------------------------------------------------|-----------------|
| `criticsRating` | `number` | Необязателен   | Рейтинг кинокритиков, возможные значения от 0 до 10.               |Изменения не требуются | 
